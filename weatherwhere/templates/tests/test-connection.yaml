{{- range $application := .Values.applications }}
apiVersion: v1
kind: Pod
metadata:
  name: {{ include "weatherwhere.fullname" $application }}-test-connection
  labels:
    app: {{ $application.appLabel }}
spec:
  containers:
    - name: curl
      image: curlimages/curl
      command: ["sh", "-c", "curl -s -o /dev/null -w '%{http_code}' {{ $application.name }}-{{ $application.servicePortName }}-service:{{ $application.servicePort }}/{{ $application.name }}"]
  restartPolicy: Never
{{- end }}